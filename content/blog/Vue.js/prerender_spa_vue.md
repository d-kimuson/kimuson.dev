---
title: "Vueã®SPAã‚’ãƒ—ãƒªãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã™ã‚‹"
thumbnail: "/thumbnails/prog_g.png"
tags:
  - "Vue.js"
  - "JavaScript"
category: "Vue.js"
date: "2020-07-17T08:27:14+09:00"
weight: 5
draft: true
---

SPAã®ãƒ—ãƒªãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã¨ã„ã†ã‚‚ã®ã‚’çŸ¥ã£ãŸã®ã§, è©¦ã—ã¦ã¿ãŸ.

SPAã®æ¬ ç‚¹ã¨ã—ã¦ã‚ˆã, ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã§ç©ºdivæŠ•ã’ã‚‹ã“ã¨ãŒã‚ã’ã‚‰ã‚Œã‚‹. ã‚¯ãƒ­ãƒ¼ãƒ©ãƒ¼ã«å„ªã—ããªã„ã¨ã‹, SEOä¸åˆ©ã«ãªã‚‹ã¨ã‹, åˆæœŸãƒšãƒ¼ã‚¸ã®ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ãŒé…ã„(?)ã¨ã‹.

ã¦ã“ã¨ã§, SSRã—ãŸã„ã‚“ã ã‘ã©, é™çš„ã«ãƒ›ã‚¹ãƒ†ã‚£ãƒ³ã‚°ã§ãã‚‹SPAã«æ¯”ã¹ã¦ã‚¤ãƒ³ãƒ•ãƒ©é¢ãŒãªã‚, å¤§æŠµã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰ã§Nodejså‹•ã‹ãã†ã¨æ€ã£ãŸã‚‰ãŠé‡‘ã‹ã‹ã‚‹ã—...æ„Ÿã˜ã§çŠ¬çŒ¿ã—ãŒã¡ã ã£ãŸã‚“ã ã‘ã©,

ãã‚‚ãã‚‚BFFã§ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã¾ã¨ã‚ã‚‹ã¨ã‹, ã‚ã‚“ã©ã†ãªã“ã¨ã‚’ã™ã‚‹ã‚ã‘ã˜ã‚ƒãªã, æœ€åˆã«ã‚¢ã‚¯ã‚»ã‚¹ã—ãŸã¨ãã«ç”Ÿæˆã•ã‚Œã‚‹DOMã‚’ãã®ã¾ã¾ã‚³ãƒ”ã‚Œã°ã„ã„ã ã‘ã˜ã‚ƒã­. ã£ã¦æ€ã£ã¦èª¿ã¹ã¦ãŸã‚‰ Prerender ãªã‚‹ã‚‚ã®ã‚’ã¿ã¤ã‘ãŸ. ã¾ã•ã«ã“ã‚Œã .

ã‚ˆãã¿ãŸã‚‰, Vueã®å…¬å¼ã‚µã‚¤ãƒˆã§ã‚‚ç´¹ä»‹ã•ã‚Œã¦ãŸ.

[Vue.js ã‚µãƒ¼ãƒã‚µã‚¤ãƒ‰ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã‚¬ã‚¤ãƒ‰ #SSR vs ãƒ—ãƒªãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚° (äº‹å‰æç”») \| Vue SSR ã‚¬ã‚¤ãƒ‰](https://ssr.vuejs.org/ja/#ssr-vs-%E3%83%97%E3%83%AA%E3%83%AC%E3%83%B3%E3%83%80%E3%83%AA%E3%83%B3%E3%82%B0-%E4%BA%8B%E5%89%8D%E6%8F%8F%E7%94%BB)

> ã‚‚ã—ã‚ãªãŸãŒã€å¹¾ã¤ã‹ã®ãƒãƒ¼ã‚±ãƒ†ã‚£ãƒ³ã‚°ã®ãƒšãƒ¼ã‚¸ã® SEO ã‚’å‘ä¸Šã•ã›ã‚‹ãŸã‚ã ã‘ã« SSR ã‚’èª¿ã¹ã¦ã„ã‚‹ã¨ã—ãŸã‚‰ (ãŸã¨ãˆã° `/`, `/about`, `/contact` ãªã©)ã€ä»£ã‚ã‚Šã« ãƒ—ãƒªãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚° (äº‹å‰æç”») ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã‚’ã‚ªã‚¹ã‚¹ãƒ¡ã—ã¾ã™ã€‚ HTML ã‚’æ€¥ã„ã§ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã™ã‚‹ãŸã‚ã« Web ã‚µãƒ¼ãƒãƒ¼ã‚’ä½¿ç”¨ã™ã‚‹ã®ã§ã¯ãªãã€ãƒ—ãƒªãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã¯ã€ãƒ“ãƒ«ãƒ‰æ™‚ã«ç‰¹å®šã®ãƒ«ãƒ¼ãƒˆã«å¯¾ã—ã¦é™çš„ãª HTML ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç”Ÿæˆã—ã¾ã™ã€‚åˆ©ç‚¹ã¯ãƒ—ãƒªãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã‚’è¨­å®šã™ã‚‹æ–¹ãŒé¥ã‹ã«ç°¡å˜ã§ã€ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã‚’å®Œå…¨ã«é™çš„ãªã‚µã‚¤ãƒˆã¨ã—ã¦ä¿ã¤ã“ã¨ãŒã§ãã‚‹ã“ã¨ã§ã™ã€‚

æœ€é«˜ã‚„ã‚“.

ã¦ã“ã¨ã§, ãªã‚“ã¡ã‚ƒã£ã¦SSRæ°—åˆ†ã§ã‚„ã£ã¦ã¿ã‚‹.

## Prerender SPA Plugin

[GitHub - chrisvfritz/prerender-spa-plugin: Prerenders static HTML in a single-page application.](https://github.com/chrisvfritz/prerender-spa-plugin)

ãƒ—ãƒªãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã™ã‚‹ãŸã‚ã®ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã§, Vue, React, Angularã«å¯¾å¿œã—ã¦ã‚‹ã£ã½ã„.

Vueç”¨ã¯, CLIãƒ—ãƒ©ã‚°ã‚¤ãƒ³ãŒã‚ã£ãŸã®ã§, ã“ã£ã¡ã‚’ä½¿ã£ãŸ.

[vue-cli-plugin-prerender-spa - npm](https://www.npmjs.com/package/vue-cli-plugin-prerender-spa)

``` bash
$ vue add prerender-spa
```

é †ç•ªã«è³ªå•ã«ç­”ãˆã¦ã„ã.

è³ªå•ã®è©³ç´°ã¯ä¸Šã®ãƒšãƒ¼ã‚¸ã«æ›¸ã„ã¦ã‚ã£ãŸ.

å…¨éƒ¨çµ‚ã‚ã‚‹ã¨, `vue.config.js` ã«è¨­å®šãŒè¿½åŠ ã•ã‚Œã‚‹.

``` javascript
// vue.config.js
module.exports = {
  ...
  pluginOptions: {
    prerenderSpa: {
      registry: undefined,
      renderRoutes: [
        '/',
        '/services',
        ...
      ],
      useRenderEvent: true,
      headless: true,
      onlyProduction: true,
    }
  }
}
```

ãƒ“ãƒ«ãƒ‰ã—ã¦, index.html è¦—ãã¨ã¡ã‚ƒã‚“ã¨ä¸­èº«ãŒã‚ã£ãŸ. æ„Ÿå‹•ğŸ˜­.

## Web Font Loader ã¸ã®å¯¾å¿œ

ã‚¦ã‚­ã‚¦ã‚­ã§ãƒ›ã‚¹ãƒ†ã‚£ãƒ³ã‚°ã—ã¦ã¿ãŸã‚‰, ä½¿ç”¨å‰ã‚ˆã‚Š Lighthouse ã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚¹ã‚³ã‚¢ãŒè½ã¡ã¦ãŸ.

70 => 55ãã‚‰ã„.

ãƒ“ãƒ«ãƒ‰ã•ã‚ŒãŸHTMLè¦—ã„ã¦ã¿ãŸã‚‰, Google Fontã®èª­ã¿è¾¼ã¿ãŒäºŒé‡ã«ãªã£ã¦ãŸ.

[Web Font Loader](https://github.com/typekit/webfontloader) ãŒ, å¾Œã‹ã‚‰æŒ¿å…¥ã—ã¦ã‚‹èª­ã¿è¾¼ã¿ã‚¿ã‚°ãŒãƒ“ãƒ«ãƒ‰æ™‚ã«ã‚‚ç”Ÿæˆã•ã‚Œã¦é‡è¤‡ã—ã¦ã‚‹ã£ã½ã„.

[å…¬å¼ã‚µã‚¤ãƒˆ](https://www.npmjs.com/package/vue-cli-plugin-prerender-spa) ç¢ºèªã—ã¦ã¿ãŸã‚‰ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã®æ–¹æ³•ãŒè¼‰ã£ã¦ãŸã®ã§, å‚è€ƒã«ã—ã¤ã¤é™¤å»ã™ã‚‹.

``` javascript
// vue.config.js
module.exports = {
  ...
  pluginOptions: {
    prerenderSpa: {
      registry: undefined,
      renderRoutes: [
        '/',
        '/services',
        ...
      ],
      useRenderEvent: true,
      headless: true,
      onlyProduction: true,
      postProcess: route => {
        route.html = route.html
          .replace(/<link rel="stylesheet" href="https:\/\/fonts.googleapis.com(.*?)>/g, '');
        return route;
      }
    }
  }
}
```

å†ãƒ“ãƒ«ãƒ‰ã—ã¦ã¿ãŸã‚‰ç„¡äº‹é™¤å»ã•ã‚Œã¦ã¦, ä»Šåº¦ã¯ã‚¹ã‚³ã‚¢ã‚‚80è¶…ãˆã¦ãŸ.
